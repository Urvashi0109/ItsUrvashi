---
import BaseLayout from '../../layouts/BaseLayout.astro';
import ProjectCard from '../../components/Project/ProjectCard.astro';
import { getAllProjects, projectCategories } from '../../lib/portfolio';

const rawBase = import.meta.env.BASE_URL;
const base = rawBase.endsWith('/') ? rawBase : rawBase + '/';
const allProjects = getAllProjects();
---

<BaseLayout
	title="All My Projects | Urvashi Choubey"
	description="Portfolio of cloud infrastructure, automation, and open source projects by Urvashi Choubey - Cloud Engineer and Kubernetes Maintainer."
>
  <div class='container py-8'>
    <!-- Page Header -->
    <div class="mb-10">
      <h1 class="text-4xl font-bold mb-3">My Projects</h1>
      <p class="text-lg text-gray-600 dark:text-gray-300">
        Things I've built, broken, fixed, and occasionally shipped to production. Here's the highlight reel!
      </p>
    </div>

    <!-- Category Tabs -->
    <div class="flex flex-wrap gap-1 mb-8 bg-gray-100 dark:bg-gray-800 p-1 rounded-lg">
      <a href={`${base}projects`} class="px-4 py-2 text-sm font-medium rounded-md bg-white dark:bg-gray-700 shadow-sm">All Projects</a>
      {projectCategories.map(category => (
        <a href={`${base}projects/${category.slug}`} class="px-4 py-2 text-sm font-medium rounded-md hover:bg-white/50 dark:hover:bg-gray-700/50 transition-colors">
          {category.name}
        </a>
      ))}
    </div>

    <!-- Projects Grid (ongoing first) -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      {[...allProjects].sort((a, b) => {
        if (a.status === 'ongoing' && b.status !== 'ongoing') return -1;
        if (a.status !== 'ongoing' && b.status === 'ongoing') return 1;
        return 0;
      }).map(project => (
        <ProjectCard {...project} />
      ))}
    </div>

    <!-- Empty State (if no projects) -->
    {allProjects.length === 0 && (
      <div class="text-center py-16">
        <p class="text-lg text-gray-400 dark:text-gray-500">No projects found.</p>
      </div>
    )}
  </div>
</BaseLayout>
