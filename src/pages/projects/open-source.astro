---
import BaseLayout from '../../layouts/BaseLayout.astro';
import ProjectCard from '../../components/Project/ProjectCard.astro';
import { getProjectsByCategory, getCategoryMetadata, projectCategories } from '../../lib/portfolio';

const rawBase = import.meta.env.BASE_URL;
const base = rawBase.endsWith('/') ? rawBase : rawBase + '/';
const category = 'open-source';
const projects = getProjectsByCategory(category);
const categoryMeta = getCategoryMetadata(category);
---

<BaseLayout
	title={`${categoryMeta?.name} | Urvashi Choubey`}
	description={`${categoryMeta?.description} - Portfolio by Urvashi Choubey`}
>
  <div class='container py-8'>
    <!-- Breadcrumbs -->
    <div class="text-sm mb-6">
      <ul class="flex items-center gap-2 text-gray-500 dark:text-gray-400">
        <li><a href={base} class="hover:text-primary">Home</a></li>
        <li>/</li>
        <li><a href={`${base}projects`} class="hover:text-primary">Projects</a></li>
        <li>/</li>
        <li class="text-gray-900 dark:text-gray-100">{categoryMeta?.name}</li>
      </ul>
    </div>

    <!-- Page Header -->
    <div class="mb-10">
      <h1 class="text-4xl font-bold mb-3">
        {categoryMeta?.name}
      </h1>
      <p class="text-lg text-gray-600 dark:text-gray-300">
        {categoryMeta?.description}
      </p>
    </div>

    <!-- Category Tabs -->
    <div class="flex flex-wrap gap-1 mb-8 bg-gray-100 dark:bg-gray-800 p-1 rounded-lg">
      <a href={`${base}projects`} class="px-4 py-2 text-sm font-medium rounded-md hover:bg-white/50 dark:hover:bg-gray-700/50 transition-colors">All Projects</a>
      {projectCategories.map(cat => (
        <a 
          href={`${base}projects/${cat.slug}`} 
          class={`px-4 py-2 text-sm font-medium rounded-md transition-colors ${cat.slug === category ? 'bg-white dark:bg-gray-700 shadow-sm' : 'hover:bg-white/50 dark:hover:bg-gray-700/50'}`}
        >
          {cat.name}
        </a>
      ))}
    </div>

    <!-- Projects Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      {projects.map(project => (
        <ProjectCard {...project} />
      ))}
    </div>

    <!-- Empty State -->
    {projects.length === 0 && (
      <div class="text-center py-16">
        <p class="text-lg text-gray-400 dark:text-gray-500">No projects in this category yet.</p>
      </div>
    )}
  </div>
</BaseLayout>
